# План реализации: Скрытие блока "Обратный звонок"

Этот документ описывает пошаговый план реализации для скрытия блока "Обратный звонок" на основе настроек с бэкенда.

## Журнал

*   **Фаза 2 (2025-10-17):** Обновлен слой данных. Добавлено поле `callback` в `SettingsEntity` и `SettingsDto`. Обновлен `SettingsMapper` и соответствующие тесты. Обнаружено, что поле `callback` уже существовало в `SettingsDto`, что было неожиданно.
*   **Фаза 1 (2025-10-17):** Все тесты успешно пройдены. Проект готов к модификации.

*Здесь будут записываться действия, наблюдения и отклонения от плана.*

---

## Фаза 1: Подготовка и первоначальное тестирование

- [x] Запустить все тесты, чтобы убедиться, что проект находится в рабочем состоянии перед началом модификаций.

**После завершения фазы:**

- [ ] Создать/изменить юнит-тесты для проверки кода, добавленного или измененного в этой фазе, если это применимо.
- [ ] Запустить инструмент `dart_fix` для очистки кода.
- [ ] Еще раз запустить инструмент `analyze_files` и исправить все возникшие проблемы.
- [ ] Запустить все тесты, чтобы убедиться, что они все проходят.
- [ ] Запустить `dart_format` для корректной формации кода.
- [ ] Повторно прочитать файл `MODIFICATION_IMPLEMENTATION.md`, чтобы увидеть, что, если что-то, изменилось в плане реализации, и если он изменился, позаботиться обо всем, что подразумевают изменения.
- [ ] Обновить файл `MODIFICATION_IMPLEMENTATION.md` с текущим состоянием, включая любые знания, сюрпризы или отклонения в разделе "Журнал". Отметить все выполненные флажки.
- [ ] Использовать `git diff` для проверки внесенных изменений и создать подходящее сообщение о коммите для любых изменений, следуя любым рекомендациям, которые у вас есть относительно сообщений о коммитах. Обязательно правильно экранируйте знаки доллара и обратные кавычки и представьте сообщение об изменении пользователю на утверждение.
- [ ] Дождаться одобрения. Не фиксировать изменения и не переходить к следующему этапу реализации, пока пользователь не одобрит коммит.
- [ ] После фиксации изменения, если приложение запущено, используйте инструмент `hot_reload` для его перезагрузки.

---

## Фаза 2: Обновление слоя данных

- [x] Модифицировать `lib/features/home/data/models/settings_dto.dart`, добавив поле `callback`.
- [x] Модифицировать `lib/features/home/domain/entities/settings_entity.dart`, добавив поле `callback`.
- [x] Запустить `dart run build_runner build --delete-conflicting-outputs` для обновления сгенерированных файлов (`.g.dart`, `.freezed.dart`).
- [x] Модифицировать `lib/features/home/data/repository/mappers/settings_mapper.dart`, чтобы он обрабатывал новое поле `callback`.

**После завершения фазы:**

- [ ] Создать/изменить юнит-тесты для проверки кода, добавленного или измененного в этой фазе, если это применимо.
- [ ] Запустить инструмент `dart_fix` для очистки кода.
- [ ] Еще раз запустить инструмент `analyze_files` и исправить все возникшие проблемы.
- [ ] Запустить все тесты, чтобы убедиться, что они все проходят.
- [ ] Запустить `dart_format` для корректной формации кода.
- [ ] Повторно прочитать файл `MODIFICATION_IMPLEMENTATION.md`, чтобы увидеть, что, если что-то, изменилось в плане реализации, и если он изменился, позаботиться обо всем, что подразумевают изменения.
- [ ] Обновить файл `MODIFICATION_IMPLEMENTATION.md` с текущим состоянием, включая любые знания, сюрпризы или отклонения в разделе "Журнал". Отметить все выполненные флажки.
- [ ] Использовать `git diff` для проверки внесенных изменений и создать подходящее сообщение о коммите для любых изменений, следуя любым рекомендациям, которые у вас есть относительно сообщений о коммитах. Обязательно правильно экранируйте знаки доллара и обратные кавычки и представьте сообщение об изменении пользователю на утверждение.
- [ ] Дождаться одобрения. Не фиксировать изменения и не переходить к следующему этапу реализации, пока пользователь не одобрит коммит.
- [ ] После фиксации изменения, если приложение запущено, используйте инструмент `hot_reload` для его перезагрузки.

---

## Фаза 3: Обновление пользовательского интерфейса

- [ ] Модифицировать `lib/features/order/presentation/widgets/more.dart`, обернув виджет "Обратный звонок" в `BlocBuilder<SettingsBloc, SettingsState>` для условного отображения.

**После завершения фазы:**

- [ ] Создать/изменить юнит-тесты для проверки кода, добавленного или измененного в этой фазе, если это применимо.
- [ ] Запустить инструмент `dart_fix` для очистки кода.
- [ ] Еще раз запустить инструмент `analyze_files` и исправить все возникшие проблемы.
- [ ] Запустить все тесты, чтобы убедиться, что они все проходят.
- [ ] Запустить `dart_format` для корректной формации кода.
- [ ] Повторно прочитать файл `MODIFICATION_IMPLEMENTATION.md`, чтобы увидеть, что, если что-то, изменилось в плане реализации, и если он изменился, позаботиться обо всем, что подразумевают изменения.
- [ ] Обновить файл `MODIFICATION_IMPLEMENTATION.md` с текущим состоянием, включая любые знания, сюрпризы или отклонения в разделе "Журнал". Отметить все выполненные флажки.
- [ ] Использовать `git diff` для проверки внесенных изменений и создать подходящее сообщение о коммите для любых изменений, следуя любым рекомендациям, которые у вас есть относительно сообщений о коммитах. Обязательно правильно экранируйте знаки доллара и обратные кавычки и представьте сообщение об изменении пользователю на утверждение.
- [ ] Дождаться одобрения. Не фиксировать изменения и не переходить к следующему этапу реализации, пока пользователь не одобрит коммит.
- [ ] После фиксации изменения, если приложение запущено, используйте инструмент `hot_reload` для его перезагрузки.

---

## Фаза 4: Завершение

- [ ] Обновить файл `README.md` (если необходимо) с информацией о новой функциональности.
- [ ] Обновить файл `GEMINI.md` (если необходимо), чтобы он корректно описывал изменения.
- [ ] Попросить вас проверить работу приложения и подтвердить, что все работает корректно.